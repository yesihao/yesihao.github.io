{"meta":{"title":"Shane In Tech Life","subtitle":"as above","description":"Shane's blog","author":"Shane Ye","url":"http://shenye.me","root":"/"},"pages":[],"posts":[{"title":"ä¸ºä»€ä¹ˆReactéœ€è¦Hooks","slug":"ä¸ºä»€ä¹ˆReactéœ€è¦Hooks","date":"2020-05-28T02:24:23.000Z","updated":"2020-06-08T13:38:18.738Z","comments":true,"path":"2020/05/28/ä¸ºä»€ä¹ˆReactéœ€è¦Hooks/","link":"","permalink":"http://shenye.me/2020/05/28/ä¸ºä»€ä¹ˆReactéœ€è¦Hooks/","excerpt":"","text":"å‰è¨€å¦‚æœä½ æ˜¯ä¸€ä¸ªReactå¼€å‘è€…ï¼Œé‚£ä¹ˆä½ ç»å¸¸ä¼šå¬åˆ°å…³äºReact hooksï¼Œä¹Ÿå°±æ˜¯æ‰€è¯´çš„é’©å­çš„è®¨è®ºã€‚è€Œå¯¹äºé‚£äº›æ²¡æœ‰ä½¿ç”¨è¿‡React hooksçš„å¼€å‘è€…æ¥è¯´ï¼Œè¿™åªæ˜¯Reactå†…ç½®çš„å‡½æ•°ï¼Œå®ƒä»¬å¯ä»¥è®©æˆ‘ä»¬è®©åœ¨functionalç»„ä»¶å†…é‡Œåšæ‰€æœ‰å¯ä»¥åœ¨classç»„ä»¶å†…åšçš„äº‹ã€‚ ä½†æ˜¯ä¸ºä»€ä¹ˆè¦ä½¿ç”¨React hookså‘¢ï¼Ÿ å¦‚æœç±»ç»„ä»¶å¯ä»¥å®Œæˆæˆ‘ä»¬å¸Œæœ›å®ƒä»¬åšçš„æ‰€æœ‰äº‹æƒ…ï¼Œæ¯”å¦‚åˆå§‹åŒ–çŠ¶æ€ï¼Œè®¾ç½®çŠ¶æ€ï¼Œè®¿é—®ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸï¼Œåˆ›å»ºä¸Šä¸‹æ–‡ï¼Œè°ƒç”¨å¼•ç”¨ç­‰ï¼Œé‚£ä¹ˆæˆ‘ä»¬ä¸ºä»€ä¹ˆè¦ä¸ºæˆ‘ä»¬çš„å±•ç¤ºæ€§ç»„ä»¶æä¾›ä¸€ç§æ–¹æ³•ï¼ŒåšåŒæ ·çš„äº‹æƒ…å‘¢ï¼Ÿfunctionalç»„ä»¶æœ‰ä»€ä¹ˆç‰¹åˆ«ä¹‹å¤„ï¼Ÿ å¥½å§ï¼Œäº‹å®è¯æ˜ï¼Œä½¿ç”¨é’©å­ä¸ºå¼€å‘äººå‘˜å¸¦æ¥å¥½å¤„çš„åŸå› æœ‰å¾ˆå¤šã€‚é¦–å…ˆæ˜¯å¤§å‹ç»„ä»¶å¯èƒ½éš¾ä»¥ä½¿ç”¨ï¼Œåœ¨å¤§å‹é¡¹ç›®ä¸Šå·¥ä½œçš„å¼€å‘è€…ä»¬ï¼Œç»„ä»¶çš„çŠ¶æ€å¯èƒ½ä¼šè¶Šæ¥æ„ˆå¤šï¼Œæ„ˆæ¥æ„ˆå¤æ‚ï¼Œå…¶å¤§å°ç»å¸¸ä¼šåœ¨ç»„ä»¶ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ä¸­æ•£å¸ƒç›¸åŒæˆ–ç›¸ä¼¼çš„é€»è¾‘ã€‚ç¬¬äºŒä¸ªæ˜¯æ–¹æ³•é‡ç”¨ï¼Œé‡ç”¨ç»„ä»¶æ–¹æ³•ï¼ˆå°¤å…¶æ˜¯å¤æ‚çš„é€»è¾‘ï¼‰ä¾èµ–äºè®¾è®¡æ¨¡å¼ï¼Œä¾‹å¦‚é«˜é˜¶ç»„ä»¶æˆ–æ¸²æŸ“å‚æ•°ï¼Œè¿™åè¿‡æ¥åˆéœ€è¦å¼€å‘äººå‘˜é‡æ–°ç»„ç»‡å…¶ç»„ä»¶å±‚æ¬¡ç»“æ„ï¼Œå¹¶å¯èƒ½å¯¼è‡´ç»„ä»¶å±‚çº§æ··ä¹±ã€‚æœ€åï¼Œç±»è¯­æ³•å¯¹å¡å‘è€…å’Œç¼–è¯‘å™¨éƒ½é€ æˆäº†æ··æ·†ï¼Œå¹¶ä¸”å¯èƒ½å¯¼è‡´Reactæ‰€è¿½æ±‚çš„çº¯ç²¹çš„åŠŸèƒ½è®¾è®¡æ¨¡å¼æ— æ³•å®ç°ã€‚ é‚£ä¹ˆé’©å­å¦‚ä½•è§£å†³è¿™äº›é—®é¢˜å‘¢ï¼Ÿ ç»„ä»¶å¤§å°å½“æ¶‰åŠåˆ°ç»„ä»¶çš„è§„æ¨¡ï¼Œå¤§å°æ—¶ï¼Œé’©å­ä½¿ç”¨useEffectæå–ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ä¸­çš„è®¸å¤šé‡å¤åŠŸèƒ½ï¼Œå¹¶ä½¿ç”¨useStateåˆå§‹åŒ–ï¼Œæ”¹å˜çŠ¶æ€ã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ªuseEffectæŒ‚é’©å¯ä»¥å®Œæˆ3ç§ç”Ÿå‘½å‘¨æœŸæ–¹æ³•çš„å·¥ä½œï¼šcomponentDidMountï¼ŒcomponentDidUpdateå’ŒcomponentWillUnmountã€‚é€šè¿‡æŒ‡å®šä¸€ä¸ªå¯é€‰çš„ä¾èµ–é¡¹æ•°ç»„ï¼Œæ‚¨å¯ä»¥å‘Šè¯‰useEffectåœ¨æŒ‡å®šçš„çŠ¶æ€å¼•ç”¨ä¸­æŸ¥æ‰¾æ›´æ”¹ï¼Œç„¶åå†æ¬¡è¿è¡Œè¯¥æ•ˆæœï¼Œç­‰æ•ˆäºcomponentDidUpdateã€‚é€šè¿‡æŒ‡å®šä¸€ä¸ªç©ºçš„ä¾èµ–å…³ç³»æ•°ç»„ï¼Œæ‚¨å¯ä»¥å‘Šè¯‰useEffectä»…è¿è¡Œä¸€æ¬¡componentDidMountã€‚å½“ä»DOMä¸­åˆ é™¤ç»„ä»¶æ—¶ï¼Œæ‚¨éœ€è¦æ‰§è¡Œä¸€äº›æ•°æ®æ¸…é™¤æ“ä½œï¼ˆä¾‹å¦‚æ¸…é™¤é—´éš”æˆ–é˜»æ­¢apiè°ƒç”¨ï¼‰ï¼Œæ‚¨å¯ä»¥åœ¨returnè¯­å¥ä¸­ä¸ºuseEffectå›è°ƒï¼Œè¯¥è¯­å¥å°†åœ¨unmount- componentWillUnmountä¸Šè¿è¡Œã€‚æ‰€æœ‰è¿™äº›å·¥ä½œéƒ½å¯ä»¥é€šè¿‡ä¸€ä¸ªuseEffectè°ƒç”¨æ¥å®Œæˆï¼Œè¿™ä½¿å…¶æˆä¸ºè§£å†³å‰¯ä½œç”¨çš„å¼ºå¤§æ–¹æ³•ï¼ æ–¹æ³•å¤ç”¨åœ¨åº”ç”¨ä¸­å…¶ä»–åœ°æ–¹é‡ç”¨ç»„ä»¶é€»è¾‘æ—¶ï¼Œæˆ‘ä»¬æ¦‚æ‹¬è¿™äº›æ–¹æ¡ˆçš„ä¼ ç»Ÿæ–¹å¼æ˜¯ä½¿ç”¨æ¸²æŸ“é“å…·æˆ–HOCï¼ˆé«˜é˜¶ç»„ä»¶ï¼‰ã€‚æ¸²æŸ“é“å…·çš„å·¥ä½œæ–¹å¼æ˜¯å°†å¸¦æœ‰ç‹¬ç«‹JSXçš„è‡ªå®šä¹‰å›è°ƒä½œä¸ºå‚æ•°,ä¼ é€’ç»™æˆ‘ä»¬çš„ç»„ä»¶ã€‚å½“æˆ‘ä»¬å¸Œæœ›ç›¸åŒçš„æ¸²æŸ“ç»„ä»¶çš„å¤šä¸ªå®ä¾‹ä¹‹é—´é‡ç”¨æ—¶ï¼Œå°±å¯ä»¥è¿™æ ·ã€‚ä¾‹å¦‚ï¼Œå¦‚æœæˆ‘ä»¬æƒ³é€šè¿‡ä¸€ä¸ªç»„ä»¶è·Ÿè¸ªé¼ æ ‡çš„ä½ç½®ï¼Œä½†æƒ³å¯¹è¯¥æ•°æ®åšä¸åŒçš„äº‹æƒ…ï¼ˆä¾‹å¦‚åœ¨pæ ‡ç­¾è€Œä¸æ˜¯h1æ ‡ç­¾ä¸­æ˜¾ç¤ºä½ç½®ï¼‰ï¼Œåˆ™å¯ä»¥é€šè¿‡æŒ‡å®šæ¸²æŸ“æ“¦è¾“æ¥å®ç°ä½¿ç”¨å®šåˆ¶çš„JSXã€‚ 12&lt;MousePosition render = &#123;position =&gt; &lt;p&gt;&#123;position&#125;&lt;/p&gt;&#125;&gt;&lt;/MousePosition&gt;&lt;MousePosition render = &#123;position =&gt; &lt;h1&gt;&#123;position&#125;&lt;/h1&gt;&#125;&gt;&lt;/MousePosition&gt; HOCï¼ˆé«˜é˜¶ç»„ä»¶ï¼‰é€šè¿‡åˆ›å»ºåŒ…è£…å™¨ç»„ä»¶æˆ–è¿”å›åŒ…è£…å™¨ç»„ä»¶çš„å‡½æ•°æ¥å®ç°ï¼Œè¯¥å‡½æ•°ä½¿åŒ…è£…çš„ç»„ä»¶å¯ä»¥è®¿é—®æŸäº›æ•°æ®æˆ–åŠŸèƒ½ã€‚å¦‚æœå¤šä¸ªç»„ä»¶æ­£åœ¨æ‰§è¡Œç›¸ä¼¼ä½†ç•¥æœ‰ä¸åŒçš„å·¥ä½œï¼Œä¾‹å¦‚ä»ç›¸åŒæ¥æºè·å–æŸäº›æ•°æ®ä½†ä½¿ç”¨ä¸åŒæ–¹æ³•ï¼Œåˆ™æˆ‘ä»¬å°†å¸Œæœ›ä½¿ç”¨æ­¤åŠŸèƒ½ã€‚æƒ³æƒ³Reduxçš„connectï¼ˆï¼‰å‡½æ•°ï¼Œå®ƒå°†åŒ…è£…å¥½çš„ç»„ä»¶è¿æ¥åˆ°æˆ‘ä»¬çš„å•†åº—ã€‚è¿™é‡Œå¯èƒ½éœ€è¦è¿æ¥å¤šä¸ªç»„ä»¶ï¼Œä½†æ˜¯çŠ¶æ€å’Œè°ƒåº¦æ–¹æ³•çš„éœ€æ±‚å´æœ‰æ‰€ä¸åŒã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥å‘æˆ‘ä»¬çš„è¿æ¥HOCæä¾›è‡ªå®šä¹‰çš„mapStateToPropså’ŒmapDispatchToPropså‡½æ•°ï¼Œä»¥ä¸ºåŒ…è£…çš„ç»„ä»¶æä¾›ä¸ªæ€§åŒ–æ•°æ®ã€‚ 1export default connect(mapStateToProps, mapDispatchToProps)(SomeComponent); å°½ç®¡è¿™äº›æ¨¡å¼å¯¹äºç±»ç»„ä»¶éå¸¸æœ‰æ•ˆï¼Œä½†å®ƒä»¬ä¹Ÿæœ‰ç¼ºç‚¹ã€‚ç‰¹åˆ«æ˜¯ï¼Œå®ƒä»¬è¦æ±‚å¼€å‘äººå‘˜é‡å†™å…¶ç»„ä»¶å±‚æ¬¡ç»“æ„ï¼Œå¹¶å¯èƒ½å¯¼è‡´åŒ…è£…å™¨åœ°ç‹±çš„ç¬¬9ä¸ªå¾ªç¯ã€‚ React hooksçš„æ›¿ä»£æ–¹æ³•æ˜¯å…è®¸æˆ‘ä»¬çš„å¯ä»¥è°ƒç”¨ä»¥è‡ªå®šä¹‰hookçš„å½¢å¼åœ¨å„â€‹â€‹ä¸ªç»„ä»¶ä¹‹é—´å…±äº«ã€‚è‡ªå®šä¹‰é’©å­åªæ˜¯å¯ç»„åˆçš„å‡½æ•°ï¼Œå¯ä»¥åƒå…¶ä»–ä»»ä½•å‡½æ•°ä¸€æ ·åœ¨ç»„ä»¶ä¹‹é—´å¯¼å‡ºå’Œå…±äº«ã€‚å¯ç»„åˆçš„æ„æ€æ˜¯æŒ‡å…·æœ‰å¤šä¸ªéƒ¨åˆ†ï¼ˆä¾‹å¦‚useStateå’ŒuseEffectè°ƒç”¨ï¼‰ï¼Œå°†å®ƒä»¬ç»„åˆä¸ºå¯é‡ç”¨æ¨¡å¼å¹¶å°†å…¶æŠ½è±¡ä¸ºè‡ªå·±çš„å•ç‹¬åŠŸèƒ½çš„èƒ½åŠ›ã€‚è¿™ç§æ¨¡å¼åœ¨ç±»ç»„ä»¶ä¸­å°†æ˜¯ä¸å¯èƒ½çš„ï¼Œå› ä¸ºåšè¯¸å¦‚è·å–æ•°æ®æˆ–å®ä¾‹åŒ–çŠ¶æ€ä¹‹ç±»çš„ç®€å•æ“ä½œä¸èƒ½ä¸è°ƒç”¨å®ƒä»¬çš„ç±»æ–¹æ³•åˆ†å¼€ã€‚ æ€§èƒ½ä¸å›°æƒ‘Finally, there are minor concerns over performance within class components. At React Conference 2018, when React Hooks were unveiled, it was pointed out that class components are difficult for both machines and people to understand. Since class syntax is simply a syntactic sugaring for JavaScriptâ€™s prototypal inheritance, classes donâ€™t work in the same way that other programming languages do. As a result, the React team has noticed problems with minifying class components in production builds and thereâ€™s been inconsistency when implementing hot module reloading. Additionally, it can be difficult for engineers, especially those new to class syntax, to understand how the binding of the â€˜thisâ€™ keyword works or other class nuances like the purpose of calling super() inside the constructor.Since hooks allow us to use all of the same class component functionality inside functional components weâ€™re able to boost the performance of our React code. Additionally, hooks have a clean syntax that is more inline with not only Reactâ€™s pure functional design, but also their focus on just JavaScript. One of Reactâ€™s main differences between other component-based front-end libraries like Vue, is its coupling of html, css, and JavaScript through JSX and css modules. This means, if youâ€™re an expert in JavaScript, then youâ€™re an expert in React (give or take implementation details) as opposed to Vueâ€™s template structure that relies on splitting files between HTML, CSS, and JS like the good old days of jQuery and vanilla JavaScript DOM manipulation.While the slight performance boost of functional components is nice, performance should not be the main reason why you use hooks. Hooks do NOT add any functionality within React that wasnâ€™t already there. Itâ€™s primary purpose is simply to elevate functional components to the same level as class components, in turn allowing for a better DX (Developer Experience) through cleaner, more maintainable code, better method reuse across components, and an easier, more declarative way of using state, life cycle methods, and a whole host of other React functionality like refs, memoization, reducers, and context.That being said, Iâ€™ve had colleagues who have found hooks to be conceptually opaque in grasping, especially when it came to understanding useEffect, useState, or useContext. For instance, it can be difficult to see how you should combine your varying logic in your life cycle methods into a singular function call. So recently, a group of engineers and I created a CLI templating tool called Hookd to instantly convert class components to functional components with hooks. Weâ€™ve just launched our Alpha version and would love contributors and feedback. If downloading a CLI is not your style we also have a client where you can c/p your components to find the hooks equivalent. æœ€åï¼Œå¤§å®¶å¯¹äºç±»ç»„ä»¶çš„æ€§èƒ½å…¶å®æ²¡æœ‰ä»€ä¹ˆæ‹…å¿ƒã€‚åœ¨2018å¹´React Conferenceä¸Šï¼Œå½“React Hooksæ­å¹•æ—¶ï¼Œæœ‰äººæŒ‡å‡ºç±»ç»„ä»¶å¯¹äºæœºå™¨å’Œäººç±»éƒ½å¾ˆéš¾ç†è§£ã€‚ç”±äºç±»è¯­æ³•åªæ˜¯JavaScriptåŸå‹ç»§æ‰¿çš„ä¸€ç§è¯­æ³•ç³–ï¼Œå› æ­¤ç±»çš„å·¥ä½œæ–¹å¼ä¸å…¶ä»–ç¼–ç¨‹è¯­è¨€ä¸åŒã€‚Reactå›¢é˜Ÿæ³¨æ„åˆ°åœ¨ç”Ÿäº§ç¯å¢ƒä¸­æœ€å°åŒ–ç±»ç»„ä»¶çš„é—®é¢˜ï¼Œå¹¶ä¸”åœ¨å®ç°çƒ­æ¨¡å—é‡æ–°åŠ è½½æ—¶å­˜åœ¨ä¸ä¸€è‡´ä¹‹å¤„ã€‚æ­¤å¤–ï¼Œå¯¹äºå¼€å‘è€…ï¼Œå°¤å…¶æ˜¯å¯¹é‚£äº›åˆšæ¥è§¦ç±»è¯­æ³•çš„å¼€å‘è€…æ¥è¯´ï¼Œå¯èƒ½å¾ˆéš¾ç†è§£â€™thisâ€™å…³é”®å­—çš„ç»‘å®šæ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Œæˆ–è€…éš¾ä»¥ç†è§£å…¶ä»–ç±»çš„ç»†å¾®å·®åˆ«ï¼Œä¾‹å¦‚åœ¨æ„é€ å‡½æ•°å†…éƒ¨è°ƒç”¨superï¼ˆï¼‰çš„ç›®çš„ã€‚ ç”±äºReact hooksä½¿æˆ‘ä»¬èƒ½å¤Ÿåœ¨åŠŸèƒ½ç»„ä»¶å†…éƒ¨ä½¿ç”¨æ‰€æœ‰ç›¸åŒçš„ç±»ç»„ä»¶åŠŸèƒ½ï¼Œå› æ­¤æˆ‘ä»¬èƒ½å¤Ÿæé«˜Reactä»£ç çš„æ€§èƒ½ã€‚æ­¤å¤–ï¼Œé’©å­å…·æœ‰ç®€æ´çš„è¯­æ³•ï¼Œä¸ä»…ä¸Reactçš„çº¯åŠŸèƒ½è®¾è®¡ç´§å¯†ç›¸å…³ï¼Œè€Œä¸”ä¸JavaScriptç´§å¯†ç›¸å…³ã€‚ Reactåœ¨å…¶ä»–åŸºäºç»„ä»¶çš„å‰ç«¯åº“ï¼ˆå¦‚Vueï¼‰ä¹‹é—´çš„ä¸»è¦åŒºåˆ«ä¹‹ä¸€æ˜¯å®ƒé€šè¿‡JSXå’Œcssæ¨¡å—å°†htmlï¼Œcsså’ŒJavaScriptè€¦åˆåœ¨ä¸€èµ·ã€‚è¿™æ„å‘³ç€ï¼Œå¦‚æœä½ æ˜¯JavaScriptä¸“å®¶ï¼Œé‚£ä¹ˆæ‚¨å°±æ˜¯Reactï¼ˆæä¾›æˆ–è·å–å®ç°ç»†èŠ‚ï¼‰ä¸“å®¶ï¼Œè€Œä¸æ˜¯åƒè¿‡å»é‚£æ ·ä¾èµ–Vueåœ¨HTMLï¼ŒCSSå’ŒJSä¹‹é—´æ‹†åˆ†æ–‡ä»¶çš„æ¨¡æ¿ç»“æ„jQueryå’ŒVanilla JSçš„DOMå¤„ç†çš„æ¦‚å¿µã€‚ å°½ç®¡åŠŸèƒ½ç»„ä»¶çš„æ€§èƒ½ç•¥æœ‰æé«˜ï¼Œä½†æ€§èƒ½ä¸åº”æˆä¸ºä½¿ç”¨React hooksçš„ä¸»è¦åŸå› ã€‚å®ƒä¹Ÿä¸ä¼šåœ¨Reactä¸­æ·»åŠ å°šä¸å­˜åœ¨çš„ä»»ä½•åŠŸèƒ½ã€‚å…¶ä¸»è¦ç›®çš„åªæ˜¯ç®€å•åœ°å°†åŠŸèƒ½ç»„ä»¶æå‡åˆ°ä¸ç±»ç»„ä»¶ç›¸åŒçš„çº§åˆ«ï¼Œä»è€Œé€šè¿‡æ›´å¹²å‡€ï¼Œæ›´å¯ç»´æŠ¤çš„ä»£ç ï¼Œæ›´å¥½åœ°åœ¨ç»„ä»¶ä¹‹é—´é‡ç”¨æ–¹æ³•ä»¥åŠæ›´ç®€å•ï¼Œæ›´å…·å£°æ˜æ€§çš„ä½¿ç”¨æ–¹å¼ï¼Œä»è€Œè·å¾—æ›´å¥½çš„DXï¼ˆå¼€å‘äººå‘˜ä½“éªŒï¼‰ã€‚ è¯è™½è¿™ä¹ˆè¯´ï¼Œä½†æˆ‘æœ‰ä¸€äº›åŒäº‹å‘ç°React hooksåœ¨æ¦‚å¿µä¸Šä¸å®¹æ˜“æŒæ¡ï¼Œå°¤å…¶æ˜¯åœ¨äº†è§£useEffectï¼ŒuseStateæˆ–useContextæ—¶ã€‚ä¾‹å¦‚ï¼Œå¾ˆéš¾çœ‹åˆ°åº”è¯¥å¦‚ä½•å°†ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ä¸­çš„å„ç§é€»è¾‘ç»„åˆæˆå•ä¸ªå‡½æ•°è°ƒç”¨ã€‚å› æ­¤ï¼Œæœ€è¿‘ï¼Œæœ‰å¼€å‘è€…åˆ›å»ºäº†ä¸€ä¸ªç§°ä¸ºHookd[https://github.com/oslabs-beta/hookd]çš„CLIæ¨¡æ¿å·¥å…·ï¼Œä»¥å°†ç±»ç»„ä»¶ç«‹å³è½¬æ¢ä¸ºå¸¦æœ‰é’©å­çš„åŠŸèƒ½ç»„ä»¶ã€‚ æ¸…ç†ä»£ç ï¼Œç†æ¸…æ€è·¯æœ€åï¼Œä½¿ç”¨React hooksä¼¼ä¹ä¸ä»…ä»…æ˜¯å¼€å‘è€…â€œè£…xâ€çš„å·¥å…·ï¼Œå®ƒå¯ä»¥è®©å¼€å‘äººè€…æ¸…ç†è‡ªå·±çš„ä»£ç ï¼Œè¿›è€Œç†æ¸…è‡ªå·±çš„æ€è·¯ã€‚æ‰€ä»¥ä¸åº”ä½ä¼°ç®€æ´å’Œå£°æ˜æ€§ä»£ç æé«˜çš„å¯è¯»æ€§ï¼Œå¼€å‘æ•ˆç‡å’Œæ¨¡å—åŒ–ä¸”å¯ç»´æŠ¤çš„åº”ç”¨ç¨‹åºçš„é‡è¦æ€§ã€‚åœ¨AIä»£æ›¿äººç±»ç¼–ç¨‹ä¹‹å‰ï¼Œæˆ‘ä»¬å¿…é¡»éµå¾ªè¿™äº›å¯ä»¥è®©æ‰“å‡»éƒ½æ¸…æ¥šç†è§£çš„çº¦æŸï¼Œè¿™æ ·æ‰æœ‰åŠ©äºé¡¹ç›®å£®å¤§ã€‚","categories":[],"tags":[{"name":"Serverless, Azure, Azure Function","slug":"Serverless-Azure-Azure-Function","permalink":"http://shenye.me/tags/Serverless-Azure-Azure-Function/"}]},{"title":"å¦‚ä½•ä½¿ç”¨VS Codeå¿«é€Ÿéƒ¨ç½²Azure Function","slug":"Azure Function Part II","date":"2020-05-05T13:15:33.000Z","updated":"2020-05-09T07:22:03.504Z","comments":true,"path":"2020/05/05/Azure Function Part II/","link":"","permalink":"http://shenye.me/2020/05/05/Azure Function Part II/","excerpt":"","text":"å‰è¨€æœ¬æ–‡å°†ä»‹ç»éƒ¨ç½²Azure Functionçš„å®Œæ•´è¿‡ç¨‹ã€‚è¿™ä¸€æ¬¡ä¼šä½¿ç”¨Node.jsä½œä¸ºå¼€å‘è¯­è¨€ï¼Œä»¥åŠä½¿ç”¨VS Codeä½œä¸ºç¼–è¾‘å™¨ã€‚ åœ¨åé¢çš„åšæ–‡ä¸­ä¼šå†™åˆ°å¦‚ä½•æé«˜Node.js Azure functionsçš„æ€§èƒ½ã€‚ è¿›å…¥æ­£é¢˜é¦–å…ˆåœ¨Azure portalä¸Šåˆ›å»ºä¸€ä¸ªFunction Appç„¶åé€‰æ‹©ä½¿ç”¨VS Codeåšä¸ºå¼€å‘ç¯å¢ƒã€‚ æˆ‘ä»¬å…ˆäº†è§£ä¸€äº›åŸºæœ¬å‚æ•°ï¼š App nameï¼šfunctionsç¾¤ç»„çš„å”¯ä¸€åç§°ã€‚è¿™ä¹Ÿæ˜¯èµ„æºæœ€ç»ˆURLçš„å°¾éƒ¨ã€‚æ¯”å¦‚App nameæ˜¯exampleï¼ŒURLå°±ä¼šæ˜¯example.azurewebsites.net Subscription: é€‰æ‹©ä½ çš„è®¢é˜… Resource group &amp; version: é€‰æ‹©å¼€å‘è¯­è¨€å’Œç‰ˆæœ¬ OS: Windowsæ˜¯é»˜è®¤çš„é€‰é¡¹ï¼Œä½†æ˜¯ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨Linux Runtime stack: æˆ‘ä»¬é€‰æ‹©nodeï¼Œç‰ˆæœ¬é€‰æ‹©10 Publish: å‘å¸ƒç±»å‹ï¼Œæˆ‘ä»¬é€‰æ‹©code Hosting plan: ç°åœ¨ä¸€ä¸ªæ¶ˆè´¹è®¡åˆ’ï¼ŒAzure Fuctionsè®¡è´¹å·²æ¬¡è®¡ç®—ï¼Œå¾ˆä¾¿å®œã€‚å…·ä½“å‚è€ƒAzure functionså®šä»· Location: é€‰æ‹©ä¸€ä¸ªèµ„æºçš„ä½ç½®ï¼Œä¸­å›½é€Ÿåº¦æœ€å¿«åº”è¯¥æ˜¯ä¸œäºšåœ°åŒº Application Insights: ç”¨äºè®°å½•æ—¥å¿—å®šä½é—®é¢˜ ç‚¹å‡»åˆ›å»ºè¿‡å‡ åˆ†é’Ÿä¹‹åï¼Œä¼šæç¤ºåˆ›å»ºæˆåŠŸã€‚ ç„¶åæˆ‘ä»¬é€‰æ‹©VS Codeä½œä¸ºå¼€å‘ç¯å¢ƒ æç¤ºæˆ‘ä»¬éœ€è¦å®‰è£…æ‰€éœ€å·¥å…·ï¼Œåœ¨ä¸Šä¸€ç¯‡åšæ–‡ä¸­ï¼Œæˆ‘ä»¬ä»‹ç»å®‰è£…äº†å¼€å‘Azure Functionsçš„å·¥å…·ã€‚è¿™é‡Œä¸å†èµ˜è¿°ã€‚ æˆ‘ä»¬æ¨èåœ¨VS Codeä¸­å®‰è£…ä¸¤ä¸ªæ‰©å±•ï¼š Azure Account: æ•´åˆAzureè´¦æˆ·å’ŒVS Code. Azure Functions: å¸®åŠ©æˆ‘ä»¬åˆ›å»ºï¼Œç»´æŠ¤ï¼Œç®¡ç†ï¼Œéƒ¨ç½²function ä¸‹ä¸€æ­¥æˆ‘ä»¬ç™»å½•çš„æˆ‘ä»¬çš„Azureè´¦å·ï¼Œç„¶åæˆ‘ä»¬å°±å¯ä»¥çœ‹åˆ°æˆ‘ä»¬åˆšåˆšå»ºç«‹çš„Function App ç°åœ¨å¯ä»¥ä½¿ç”¨Azure Functionsæ‰©å±•åºŠä¸€ä¸ªHTTP triggerçš„function ç„¶åè¾“å…¥Functionåç§°ï¼Œé€‰æ‹©â€˜Functionâ€™ä½œä¸ºç¼±ç»»ç­‰çº§ ç°åœ¨æˆ‘ä»¬å·²ç»åˆ›å»ºäº†ä¸€ä¸ªfunctionã€‚ä¸»æ–‡ä»¶æ˜¯index.jsã€‚è¿™æ˜¯ä¸€ä¸ªæ¨¡ç‰ˆï¼Œå®ƒæ¥å—ä¸€ä¸ªgetæˆ–postè¯·æ±‚ï¼Œåœ¨å‚æ•°ä¸­å¦‚æœæœ‰nameå­—æ®µï¼Œåˆ™è¿”å›â€œHello â€ + (req.query.name || req.body.name)ï¼Œå¦åˆ™è¿”å›400é”™è¯¯. å¦å¤–ä¸€ä¸ªé‡è¦çš„æ–‡ä»¶æ˜¯function.jsonï¼Œå®ƒåŒ…å«äº†ä¸€äº›é…ç½®ã€‚æ¯”è¾ƒå¸¸ç”¨çš„é…ç½®æ˜¯HTTPè¯·æ±‚æ–¹å¼ã€‚ä½ å¯ä»¥é€‰æ‹©GET, POST, PUT, DELETE, OPTIONSç­‰ã€‚ æµ‹è¯•ä½ çš„Functionç„¶åéƒ¨ç½²åˆ°Azureæœ¬åœ°è¿è¡Œä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥æ–­ç‚¹è¿›è¡Œè°ƒè¯•ã€‚ æ¥ä¸‹æ¥æˆ‘ä»¬è¦éƒ¨ç½²åˆ°è¿™ä¸ªfunctionï¼Œé€‰ä¸­functionåç§°ï¼Œå³é”®ï¼Œé€‰æ‹©â€œDeploy to Function Appâ€¦â€ é€‰æ‹©ä½ æƒ³éƒ¨ç½²åˆ°çš„Fnction App å¦‚æœæ²¡æœ‰é—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥æ”¶åˆ°ä¸€ä¸ªéƒ¨ç½²æˆåŠŸçš„æç¤º æ€»ç»“ä½¿ç”¨VS Codeå¼€å‘æ˜¯éå¸¸é«˜æ•ˆçš„ï¼Œå®ƒé›†åˆAzureå®˜æ–¹çš„æ‰©å±•ï¼Œæ‰€ä»¥å¾ˆå®¹æ˜“åœ°æœ¬åœ°å¼€å‘å’Œéƒ¨ç½²åˆ°Azureã€‚","categories":[],"tags":[{"name":"Serverless, Azure, Azure Function, VS Code","slug":"Serverless-Azure-Azure-Function-VS-Code","permalink":"http://shenye.me/tags/Serverless-Azure-Azure-Function-VS-Code/"}]},{"title":"Azure Functions - é…ç½®å¼€å‘ç¯å¢ƒ","slug":"Azure Function Part I","date":"2020-03-29T12:55:10.000Z","updated":"2020-04-08T01:50:42.196Z","comments":true,"path":"2020/03/29/Azure Function Part I/","link":"","permalink":"http://shenye.me/2020/03/29/Azure Function Part I/","excerpt":"","text":"å‰è¨€è¯´Azure functionsä¹‹å‰å…ˆæ¥è¯´è¯´Serverlessã€‚Serverlessæ˜¯æœ€è¿‘å¾ˆç«çš„ä¸€ä¸ªæ¦‚å¿µï¼Œå®ƒæ˜¯ä¸€ç§åŸºäºäº’è”ç½‘çš„æŠ€æœ¯æ¶æ„ç†å¿µï¼Œåº”ç”¨é€»è¾‘å¹¶éå…¨éƒ¨åœ¨æœåŠ¡ç«¯å®ç°ï¼Œè€Œæ˜¯é‡‡ç”¨FAASï¼ˆFunction as a Serviceï¼‰æ¶æ„ï¼Œé€šè¿‡åŠŸèƒ½ç»„åˆæ¥å®ç°åº”ç”¨ç¨‹åºé€»è¾‘ã€‚åº”ç”¨ä¸šåŠ¡é€»è¾‘å°†åŸºäºFAASæ¶æ„å½¢æˆç‹¬ç«‹ä¸ºå¤šä¸ªç›¸äº’ç‹¬ç«‹åŠŸèƒ½ç»„ä»¶ï¼Œå¹¶ä»¥APIæœåŠ¡çš„å½¢å¼å‘å¤–æä¾›æœåŠ¡ï¼›å¾ˆå¤šå…¬å¸éƒ½åœ¨è‡ªå·±çš„äº‘å¹³å°æ¨å‡ºäº†FAASï¼Œæ¯”å¦‚Amazon Lambdaï¼ŒAzure Functionï¼ŒGoogle Cloud Functionsï¼Œé˜¿é‡Œäº‘Function Computeç­‰ã€‚ å¾®è½¯çš„Azure functionsæ˜¯åŸºäºAzureçš„æ— æœåŠ¡å™¨è®¡ç®—æœåŠ¡ï¼Œå¯ä»¥å¿«é€Ÿçš„å¸®åŠ©ç”¨æˆ·æ„å»ºä¸€ä¸ªåŸºäºäº‹ä»¶é©±åŠ¨çš„åº”ç”¨æ¶æ„ã€‚ç”¨æˆ·æ— éœ€å…³å¿ƒæœåŠ¡å™¨çš„éƒ¨ç½²è¿è¥ï¼Œåªéœ€ä¸“æ³¨äºæ ¸å¿ƒçš„é€»è¾‘ï¼Œæ—¢å¯ä»¥å‘å¸ƒä¸Šçº¿ã€‚è´¹ç”¨æŒ‰ç…§å®é™…è°ƒç”¨æ¬¡æ•°ä¸æ—¶é•¿è®¡è´¹ï¼Œè‡ªåŠ¨ç¼©æ”¾ï¼Œä»…åœ¨è¿è¡Œå‡½æ•°æ—¶ä¸ºè®¡ç®—èµ„æºä»˜è´¹ã€‚æ›´æ£’çš„æ˜¯Azure Functionsæ”¯æŒC#ï¼ŒPythonï¼ŒJavascriptï¼ŒTypeScriptï¼ŒF#å’ŒJavaï¼Œæœ¬æ–‡å¸¦å¤§å®¶å¿«é€Ÿçœ‹åœ¨æœ¬åœ°æ­å»ºJavascriptå¼€å‘ç¯å¢ƒå¼€å‘Azure Functionsã€‚ ç¯å¢ƒå®‰è£å¯ä»¥ä½¿ç”¨Visual Studio Codeå’ŒVisual Studioå¼€å‘ï¼Œæœ¬æ–‡å°†ä¼šä½¿ç”¨çš„VS Codeã€‚ é¦–å…ˆåœ¨æ‰©å±•å¸‚åœºä¸­æœç´¢Azure functionsï¼Œä½ ä¹Ÿå¯ä»¥ç›´æ¥å®‰è£Azure App Serviceï¼Œè¿™æ ·ä½ å°±æ‹¥æœ‰æ‰€æœ‰ç›¸å…³æ‰©å±•æœåŠ¡ï¼Œä¹Ÿå¯ä»¥ä»…å®‰è£Azure Functionsã€‚ æ¥è‘—ï¼Œæˆ‘ä»¬è¦å®‰è£ Azure Function Core Toolsï¼Œåœ¨å‘½ä»¤è¡Œå®‰è£…ï¼š 12345678910#via npmnpm i -g azure-functions-core-tools --unsafe-perm true#Linuxwget -q https://packages.microsoft.com/config/ubuntu/19.04/packages-microsoft-prod.debsudo dpkg -i packages-microsoft-prod.deb#Macbrew tap azure/functionsbrew install azure-functions-core-tools æˆ–è€…æˆ‘ä»¬å¯ä»¥ç‚¹å‡»Debug | Run, VS Codeä¼šè‡ªåŠ¨æç¤ºå®‰è£…Azure Function Core Toolsï¼Œç¡®å®šåè‡ªåŠ¨æ‰§è¡Œä¸Šæ–¹å‘½ä»¤ã€‚ å®‰è£æˆåŠŸä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥åœ¨å‘½ä»¤è¡Œè¾“å…¥ func æ¥æ£€æŸ¥æ˜¯å¦å®‰è£…æˆåŠŸã€‚ å‡ºç° é—ªç”µ å°±è¯´æ˜å®‰è£…æˆåŠŸäº†ï¼ ##é¢„å‘Š ä¸‹ä¸€ç¯‡åšæ–‡å°†ä¼šè®²åˆ° å¦‚ä½•å¿«é€Ÿéƒ¨ç½²Azure Function","categories":[],"tags":[{"name":"Serverless, Azure, Azure Function","slug":"Serverless-Azure-Azure-Function","permalink":"http://shenye.me/tags/Serverless-Azure-Azure-Function/"}]},{"title":"Javascript - æ’åºæ’åºçš„å°æŠ€å·§","slug":"Javascript - æ’åºæ’åºçš„å°æŠ€å·§","date":"2020-02-28T11:34:40.000Z","updated":"2020-04-01T04:57:55.188Z","comments":true,"path":"2020/02/28/Javascript - æ’åºæ’åºçš„å°æŠ€å·§/","link":"","permalink":"http://shenye.me/2020/02/28/Javascript - æ’åºæ’åºçš„å°æŠ€å·§/","excerpt":"","text":"æ™®é€šæ•°ç»„:1let fruits = [`bananas`, `Apples`, `Oranges`]; å¾ˆç®€å•ï¼Œä¸€è¡Œæå®šï¼š 1fruits.sort(); ä½†æ˜¯è¦æ³¨æ„æ•°ç»„ä¸­ä¸åŒå­—ç¬¦ä¸²çš„å¤§å°å†™ä¸ä¸€è‡´â€¦ å¤§å†™çš„å­—ç¬¦ä¼šè¢«æ’åœ¨å°å†™å­—ç¬¦ä¹‹å‰ğŸ˜‚æ‰€ä»¥è¿˜æœ‰å…¶ä»–çš„æ­¥éª¤ï¼š 1234567let fruits = [`bananas`, `Apples`, `Oranges`];fruits.sort((a, b) =&gt; &#123; return a.toLowerCase().localeCompare(b.toLowerCase());&#125;)console.log(fruits);// [\"Apples\", \"bananas\", \"Oranges\"] å¯¹è±¡æ•°ç»„ï¼ˆæŒ‰å¯¹è±¡é”®å€¼æ’åºï¼‰å¯¹å¯¹è±¡æ•°ç»„çš„æ’åºä¼šå˜å¾—å¾ˆç¨å¾®æ›´å¤æ‚ä¸€äº›ã€‚ç»å¸¸æˆ‘ä»¬ä¼šåœ¨å¤„ç†JSON APIçš„æ—¶å€™é‡åˆ°ã€‚ 1234567891011let fruits = [ &#123; fruit: `Bananas` &#125;, &#123; fruit: `apples` &#125;, &#123; fruit: `Oranges` &#125;]; æˆ‘ä»¬å¯ä»¥ä¸ºæ­¤å†™ä¸€ä¸ªæ’åºå‡½æ•°ï¼Œä½†æ˜¯æ›´è¿›ä¸€æ­¥æˆ‘ä»¬éœ€è¦ä¸€ä¸ªæ›´é€šç”¨çš„æ–¹æ³•æŠŠéœ€è¦æ’åºçš„é”®ä»¥å‚æ•°çš„å½¢å¼ä¼ è¿›å» 1234567891011121314const propComparator = (propName) =&gt; (a, b) =&gt; a[propName].toLowerCase() == b[propName].toLowerCase() ? 0 : a[propName].toLowerCase() &lt; b[propName].toLowerCase() ? -1 : 1So now we can use it to sort:fruits.sort(propComparator(`fruit`));console.log(fruits);/*[ &#123;fruit: \"apples\"&#125;, &#123;fruit: \"Bananas\"&#125;, &#123;fruit: \"Oranges\"&#125;]*/ æ™®é€šå¯¹è±¡å¦‚æœæˆ‘ä»¬æœ‰ä¸ªå¯¹è±¡æ˜¯è¿™æ ·çš„ï¼š 12345let fruits = &#123; Bananas: true, apples: false, Oranges: true&#125;; æˆ‘ä»¬ä¾ç„¶å¯ä»¥å°†é‚£äº›é”®å°å†™åŒ–ï¼Œç„¶åæˆ‘ä»¬å…ˆæ’åºé”®çš„æ•°ç»„ï¼Œç„¶åç”¨æ’åºå¥½çš„é”®æ•°ç»„å»ºä¸€ä¸ªæ–°å¯¹è±¡ 123456789101112131415let sortedFruits = &#123;&#125;;Object.keys(fruits).sort((a, b) =&gt; &#123; return a.toLowerCase().localeCompare(b.toLowerCase());&#125;).forEach(function(key) &#123; sortedFruits[key] = fruits[key];&#125;);console.log(sortedFruits);/*&#123; apples: false, Bananas: true, Oranges: true&#125;*/ å¯¹è±¡æ•°ç»„ï¼ˆæŒ‰å¯¹è±¡é”®æ’åºï¼‰1234567891011let fruits = [ &#123; Bananas: true &#125;, &#123; Apples: false &#125;, &#123; oranges: true &#125;]; å¯èƒ½è¿™æ˜¯ä¸Šè¿°æƒ…å†µä¸­æœ€å¤æ‚ï¼Œä½†æ˜¯ç»“åˆæ‰€æœ‰çš„æ–¹æ³•ï¼Œå…¶å®ä¹Ÿå¾ˆç®€å•ğŸ¶","categories":[],"tags":[{"name":"Javascript, array","slug":"Javascript-array","permalink":"http://shenye.me/tags/Javascript-array/"}]}]}